<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tetrahedron Lab</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background-color: #000;
      color: white;
      font-family: sans-serif;
    }
    #info {
      position: absolute;
      top: 10px;
      left: 10px;
      background: rgba(0, 0, 0, 0.5);
      padding: 10px;
      border-radius: 8px;
    }
  </style>
</head>
<body>
  <div id="info">
    <b>–ö–µ—Ä—É–≤–∞–Ω–Ω—è:</b><br>
    –û–±–µ—Ä—Ç–∞–π –º–∏—à–µ—é, –∫–ª—ñ–∫–∞–π –¥–ª—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è —á–µ—Ä–≤–æ–Ω–æ—ó —Ç–æ—á–∫–∏.<br>
    –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–∏ —Ç–æ—á–∫–∏ –≤–∏–¥–Ω–æ –≤ –∫–æ–Ω—Å–æ–ª—ñ (Ctrl+Shift+I ‚Üí Console).
  </div>

  <!-- –ü—ñ–¥–∫–ª—é—á–∞—î–º–æ Three.js -->
  <script src="https://cdn.jsdelivr.net/npm/three@0.157.0/build/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.157.0/examples/js/controls/OrbitControls.js"></script>

  <script>
    // === –°—Ü–µ–Ω–∞ ===
    const scene = new THREE.Scene();

    // === –ö–∞–º–µ—Ä–∞ ===
    const camera = new THREE.PerspectiveCamera(
      60, window.innerWidth / window.innerHeight, 0.1, 1000
    );
    camera.position.set(3, 3, 3);

    // === –†–µ–Ω–¥–µ—Ä–µ—Ä ===
    const renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);

    // === –ö–æ–Ω—Ç—Ä–æ–ª–µ—Ä–∏ –º–∏—à—ñ ===
    const controls = new THREE.OrbitControls(camera, renderer.domElement);
    controls.enableDamping = true;

    // === –û—Å–≤—ñ—Ç–ª–µ–Ω–Ω—è ===
    const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
    scene.add(ambientLight);
    const pointLight = new THREE.PointLight(0xffffff, 1);
    pointLight.position.set(5, 5, 5);
    scene.add(pointLight);

    // === –í–µ—Ä—à–∏–Ω–∏ —Ç–µ—Ç—Ä–∞–µ–¥—Ä–∞ ===
    const vertices = [
      new THREE.Vector3(1, 1, 1),    // IQ
      new THREE.Vector3(-1, -1, 1),  // EQ
      new THREE.Vector3(-1, 1, -1),  // Viglyad
      new THREE.Vector3(1, -1, -1)   // Uspishnist
    ];

    // === –ì—Ä–∞–Ω—ñ —Ç–µ—Ç—Ä–∞–µ–¥—Ä–∞ ===
    const geometry = new THREE.BufferGeometry();
    geometry.setFromPoints(vertices);
    geometry.setIndex([
      0, 1, 2,
      0, 1, 3,
      0, 2, 3,
      1, 2, 3
    ]);
    geometry.computeVertexNormals();

    // === –ú–∞—Ç–µ—Ä—ñ–∞–ª ===
    const material = new THREE.MeshPhongMaterial({
      color: 0x00aaff,
      wireframe: true,
      opacity: 0.9,
      transparent: true
    });

    // === –ú–µ—à (–æ–±‚Äô—î–∫—Ç) ===
    const tetrahedron = new THREE.Mesh(geometry, material);
    scene.add(tetrahedron);

    // === –ü—ñ–¥–ø–∏—Å–∏ –≤–µ—Ä—à–∏–Ω ===
    const labels = [
      { text: "IQ", position: vertices[0] },
      { text: "EQ", position: vertices[1] },
      { text: "Viglyad", position: vertices[2] },
      { text: "Uspishnist", position: vertices[3] }
    ];

    const canvas = document.createElement('canvas');
    const ctx = canvas.getContext('2d');
    ctx.font = '20px Arial';
    ctx.fillStyle = 'white';

    labels.forEach(label => {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.fillText(label.text, 10, 20);
      const texture = new THREE.CanvasTexture(ctx.canvas);
      const spriteMaterial = new THREE.SpriteMaterial({ map: texture });
      const sprite = new THREE.Sprite(spriteMaterial);
      sprite.position.copy(label.position.clone().multiplyScalar(1.2));
      sprite.scale.set(0.5, 0.25, 1);
      scene.add(sprite);
    });

    // === –ß–µ—Ä–≤–æ–Ω–∞ —Ç–æ—á–∫–∞ ===
    const dotGeometry = new THREE.SphereGeometry(0.05, 16, 16);
    const dotMaterial = new THREE.MeshBasicMaterial({ color: 0xff0000 });
    const dot = new THREE.Mesh(dotGeometry, dotMaterial);
    scene.add(dot);
    dot.visible = false;

    // === –û–±—Ä–æ–±–∫–∞ –∫–ª—ñ–∫—É ===
    const raycaster = new THREE.Raycaster();
    const mouse = new THREE.Vector2();

    function onMouseClick(event) {
      mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
      mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;

      raycaster.setFromCamera(mouse, camera);
      const intersects = raycaster.intersectObject(tetrahedron);

      if (intersects.length > 0) {
        const point = intersects[0].point;
        dot.position.copy(point);
        dot.visible = true;
        console.log("üìç –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–∏ –≤–∏–±—Ä–∞–Ω–æ—ó —Ç–æ—á–∫–∏:", point);
      }
    }

    window.addEventListener("click", onMouseClick);

    // === –ê–Ω—ñ–º–∞—Ü—ñ—è ===
    function animate() {
      requestAnimationFrame(animate);
      controls.update();
      renderer.render(scene, camera);
    }

    animate();

    // === –ú–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è –ø—Ä–∏ –∑–º—ñ–Ω—ñ —Ä–æ–∑–º—ñ—Ä—É ===
    window.addEventListener("resize", () => {
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
    });
  </script>
</body>
</html>
